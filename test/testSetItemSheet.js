function testSetItemSheet_() {
  console.log("itemsシートの項目名チェックを開始します");
  const sheet = get_sheets();
  sheet.quotation_request.getRange("A2").setValue("test");
  sheet.trial.getRange("B44").setValue(1);
  const testScenarios = [
    {
      trialType: "医師主導治験",
      irb: "IRB承認確認、施設管理",
      account: "初期アカウント設定（施設・ユーザー）",
      interim: "中間解析プログラム作成、解析実施（ダブル）",
      finalAnalysis: "最終解析プログラム作成、解析実施（ダブル）",
      csr: "CSRの作成支援",
    },
    {
      trialType: "特定臨床研究",
      irb: "IRB準備・承認確認",
      account: "初期アカウント設定（施設・ユーザー）、IRB承認確認",
      interim: "中間解析プログラム作成、解析実施（シングル）",
      finalAnalysis: "最終解析プログラム作成、解析実施（シングル）",
      csr: "研究結果報告書の作成",
    },
    {
      trialType: "観察研究・レジストリ",
      irb: "IRB準備・承認確認",
      account: "初期アカウント設定（施設・ユーザー）、IRB承認確認",
      interim: "中間解析プログラム作成、解析実施（シングル）",
      finalAnalysis: "最終解析プログラム作成、解析実施（シングル）",
      csr: "研究結果報告書の作成",
    },
    {
      trialType: "介入研究（特定臨床研究以外）",
      irb: "IRB準備・承認確認",
      account: "初期アカウント設定（施設・ユーザー）、IRB承認確認",
      interim: "中間解析プログラム作成、解析実施（シングル）",
      finalAnalysis: "最終解析プログラム作成、解析実施（シングル）",
      csr: "研究結果報告書の作成",
    },
    {
      trialType: "先進",
      irb: "IRB承認確認、施設管理",
      account: "初期アカウント設定（施設・ユーザー）",
      interim: "中間解析プログラム作成、解析実施（ダブル）",
      finalAnalysis: "最終解析プログラム作成、解析実施（ダブル）",
      csr: "CSRの作成支援",
    },
  ];
  testScenarios.forEach((testScenario) => {
    sheet.trial.getRange("B27").setValue(testScenario.trialType);
    SpreadsheetApp.flush();
    const totalItemNames = sheet.total.getRange("C:C").getValues().flat();
    const expectedItemNames = getTotalItemNames_(testScenario);
    expectedItemNames.forEach((expectedItemName, index) => {
      const actualItemName = totalItemNames[index];
      if (actualItemName !== expectedItemName) {
        throw new Error(
          `試験種別「${
            testScenario.trialType
          }」の場合、試験項目名が異なります。行番号:${
            index + 1
          } 期待値:"${expectedItemName}" 実際の値:"${actualItemName}"`
        );
      }
    });
    console.log(
      `✅ 試験種別「${testScenario.trialType}」の場合、試験項目名が正しいことを確認しました`
    );
  });
}
function getTotalItemNames_(items) {
  const totalItemNames = [
    "",
    "",
    "",
    "項目",
    "",
    "プロトコルレビュー・作成支援",
    "検討会実施（TV会議等）",
    "",
    "PMDA相談資料作成支援",
    "",
    "AMED申請資料作成支援",
    "",
    "プロジェクト管理",
    "",
    "事務局運営（試験開始前）",
    "キックオフミーティング準備・実行",
    "症例検討会準備・実行",
    "SOP一式、CTR登録案、TMF管理",
    items.irb,
    "特定臨床研究法申請資料作成支援",
    "契約・支払手続、実施計画提出支援",
    "薬剤対応",
    "事務局運営（試験開始後から試験終了まで）",
    "事務局運営（試験終了時）",
    "PMDA対応、照会事項対応",
    "監査対応",
    "",
    "モニタリング準備業務（関連資料作成）",
    "開始前モニタリング・必須文書確認",
    "症例モニタリング・SAE対応",
    "",
    "問い合わせ対応",
    "EDCライセンス・データベースセットアップ",
    "データベース管理料",
    "",
    "",
    "業務分析・DM計画書の作成・CTR登録案の作成",
    "紙CRFのEDC代理入力（含む問合せ）",
    "",
    "DB作成・eCRF作成・バリデーション",
    "バリデーション報告書",
    items.account,
    "入力の手引作成",
    "",
    "ロジカルチェック、マニュアルチェック、クエリ対応",
    "データクリーニング",
    "",
    "データベース固定作業、クロージング",
    "症例検討会資料作成",
    "",
    "安全性管理事務局業務",
    "効果安全性評価委員会事務局業務",
    "",
    "統計解析計画書・出力計画書・解析データセット定義書・解析仕様書作成",
    items.interim,
    "中間解析報告書作成（出力結果＋表紙）",
    items.finalAnalysis,
    "最終解析報告書作成（出力結果＋表紙）",
    "",
    items.csr,
    "",
    "監査計画書作成",
    "施設監査",
    "監査報告書作成",
    "",
    "試験開始準備費用",
    "症例登録",
    "症例報告",
    "",
    "国内学会発表",
    "国際学会発表",
    "論文作成",
    "",
    "名古屋医療センターCRB申請費用(初年度)",
    "名古屋医療センターCRB申請費用(2年目以降)",
    "",
    "外部監査費用",
    "施設監査費用",
    "",
    "保険料",
    "",
    "QOL調査",
    "治験薬運搬",
    "治験薬管理（中央）",
    "翻訳",
    "CDISC対応費",
    "中央診断謝金",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "（税抜）",
    "",
    "（税込）",
  ];
  return totalItemNames;
}

function testCheckItemPrices_(sheet, rowNumberItemNamePriceArray) {
  rowNumberItemNamePriceArray.forEach(([rowNumber, itemName, price]) => {
    sheet.items.getRange(rowNumber, 2).setValue(itemName);
    SpreadsheetApp.flush();
    const actualPrice = sheet.items.getRange(rowNumber, 3).getValue();
    const expectedPrice = price === null ? "" : price;
    if (String(actualPrice) !== String(expectedPrice)) {
      throw new Error(
        `試験項目名「${itemName}」の場合、価格が異なります。期待値:${expectedPrice} 実際の値:${actualPrice}`
      );
    }
  });
}
const rowNumberItemNamePriceArray_cofficients10 = [
  [4, "プロトコルレビュー・作成支援", 975000],
  [4, "プロトコルレビュー・作成支援（図表案、統計解析計画書案を含む）", 975000],
  [5, "検討会実施（TV会議等）", 81000],
  [5, "検討会実施", 81000],
  [7, "PMDA相談資料作成支援", 500000],
  [9, "AMED申請資料作成支援", 200000],
  [9, "日本医師会申請資料作成支援", 200000],
  [13, "事務局運営（試験開始前）", 195000],
  [13, "事務局運営(TV会議含む)", 195000],
  [13, "問い合わせ対応(FPI以降)", 195000],
  [14, "ミーティング準備・実行", 406000],
  [14, "Webミーティング準備・実行", 81000],
  [14, "キックオフミーティング準備・実行", 406000],
  [14, "Webキックオフミーティング準備・実行", 81000],
  [15, "症例検討会準備・実行", 406000],
  [15, "Web症例検討会準備・実行", 81000],
  [16, "関連資料作成（各種計画書、マニュアル等）", 488000],
  [16, "SOP一式、CTR登録案、TMF管理", 488000],
  [16, "CTR登録案", 200000],
  [17, "IRB準備・承認確認", 16000],
  [17, "IRB承認確認、施設管理", 16000],
  [18, "特定臨床研究法申請資料作成支援", 33000],
  [19, "契約・支払手続、治験薬搬入手続き、治験届", 130000],
  [19, "契約・支払手続、実施計画提出支援", 130000],
  [20, "薬剤対応", 65000],
  [21, "事務局運営（試験開始後から試験終了まで）", 130000],
  [22, "事務局運営（試験終了時）", 260000],
  [23, "PMDA対応、照会事項対応", 2600000],
  [24, "監査対応", 325000],
  [26, "モニタリング準備業務（関連資料作成）", 780000],
  [27, "開始前モニタリング・必須文書確認", 130000],
  [27, "開始前モニタリング", 130000],
  [27, "必須文書確認", 130000],
  [28, "症例モニタリング", 260000],
  [28, "症例モニタリング・SAE対応", 260000],
  [30, "問い合わせ対応", 10000],
  [31, "EDCライセンス・データベースセットアップ", 800000],
  [31, "データベースセットアップ", 800000],
  [32, "データベース管理料", 80000],
  [35, "業務分析・DM計画書の作成・CTR登録案の作成", 390000],
  [35, "業務分析・DM計画書の作成", 390000],
  [35, "業務分析", 390000],
  [36, "紙CRFのEDC代理入力（含む問合せ）", 10000],
  [40, "初期アカウント設定（施設・ユーザー）", 12000],
  [40, "初期アカウント設定（施設・ユーザー）、IRB承認確認", 25000],
  [40, "IRB承認確認", 2000],
  [41, "入力の手引作成", 150000],
  [46, "データベース固定作業、クロージング", 250000],
  [47, "症例検討会資料作成", 650000],
  [49, "安全性管理事務局業務", 75000],
  [50, "効果安全性評価委員会事務局業務", 75000],
  [52, "統計解析計画書作成", 400000],
  [52, "統計解析計画書・出力計画書作成", 800000],
  [
    52,
    "統計解析計画書・出力計画書・解析データセット定義書・解析仕様書作成",
    1600000,
  ],
  [53, "中間解析プログラム作成、解析実施（シングル）", 32000],
  [53, "中間解析プログラム作成、解析実施（ダブル）", 56000],
  [54, "中間解析報告書作成（出力結果＋表紙）", 32000],
  [55, "最終解析プログラム作成、解析実施（シングル）", 32000],
  [55, "最終解析プログラム作成、解析実施（ダブル）", 56000],
  [56, "最終解析報告書作成（出力結果＋表紙）", 32000],
  [58, "研究結果報告書の作成", 1950000],
  [58, "CSRの作成支援", 3900000],
  [60, "監査計画書作成", 0],
  [61, "施設監査", 0],
  [62, "監査報告書作成", 0],
  [64, "試験開始準備費用", 0],
  [65, "症例登録", 0],
  [65, "症例報告", 0],
  [66, "症例登録", 0],
  [66, "症例報告", 0],
  [68, "国内学会発表", 0],
  [69, "国際学会発表", 0],
  [70, "論文作成", 200000],
  [72, "名古屋医療センターCRB申請費用(初年度)", 800000],
  [73, "名古屋医療センターCRB申請費用(2年目以降)", 200000],
  [75, "外部監査費用", 500000],
  [76, "施設監査費用", 300000],
  [78, "保険料", 0],
  [80, "QOL調査", 0],
  [81, "治験薬運搬", 100000],
  [82, "治験薬管理（中央）", 2000000],
  [83, "翻訳", 3000],
  [84, "CDISC対応費", 20000000],
  [85, "中央診断謝金", 0],
];
const rowNumberItemNamePriceArray_cofficients15 = [
  [4, "プロトコルレビュー・作成支援", 1463000],
  [
    4,
    "プロトコルレビュー・作成支援（図表案、統計解析計画書案を含む）",
    1463000,
  ],
  [5, "検討会実施（TV会議等）", 122000],
  [5, "検討会実施", 122000],
  [7, "PMDA相談資料作成支援", 750000],
  [9, "AMED申請資料作成支援", 300000],
  [9, "日本医師会申請資料作成支援", 300000],
  [13, "事務局運営（試験開始前）", 293000],
  [13, "事務局運営(TV会議含む)", 293000],
  [13, "問い合わせ対応(FPI以降)", 293000],
  [14, "ミーティング準備・実行", 609000],
  [14, "Webミーティング準備・実行", 122000],
  [14, "キックオフミーティング準備・実行", 609000],
  [14, "Webキックオフミーティング準備・実行", 122000],
  [15, "症例検討会準備・実行", 609000],
  [15, "Web症例検討会準備・実行", 122000],
  [16, "関連資料作成（各種計画書、マニュアル等）", 732000],
  [16, "SOP一式、CTR登録案、TMF管理", 732000],
  [16, "CTR登録案", 300000],
  [17, "IRB準備・承認確認", 24000],
  [17, "IRB承認確認、施設管理", 24000],
  [18, "特定臨床研究法申請資料作成支援", 50000],
  [19, "契約・支払手続、治験薬搬入手続き、治験届", 195000],
  [19, "契約・支払手続、実施計画提出支援", 195000],
  [20, "薬剤対応", 98000],
  [21, "事務局運営（試験開始後から試験終了まで）", 195000],
  [22, "事務局運営（試験終了時）", 390000],
  [23, "PMDA対応、照会事項対応", 3900000],
  [24, "監査対応", 488000],
  [26, "モニタリング準備業務（関連資料作成）", 1170000],
  [27, "開始前モニタリング・必須文書確認", 195000],
  [27, "開始前モニタリング", 195000],
  [27, "必須文書確認", 195000],
  [28, "症例モニタリング", 390000],
  [28, "症例モニタリング・SAE対応", 390000],
  [30, "問い合わせ対応", 15000],
  [31, "EDCライセンス・データベースセットアップ", 1200000],
  [31, "データベースセットアップ", 1200000],
  [32, "データベース管理料", 120000],
  [35, "業務分析・DM計画書の作成・CTR登録案の作成", 585000],
  [35, "業務分析・DM計画書の作成", 585000],
  [35, "業務分析", 585000],
  [36, "紙CRFのEDC代理入力（含む問合せ）", 15000],
  [40, "初期アカウント設定（施設・ユーザー）", 18000],
  [40, "初期アカウント設定（施設・ユーザー）、IRB承認確認", 38000],
  [40, "IRB承認確認", 3000],
  [41, "入力の手引作成", 225000],
  [46, "データベース固定作業、クロージング", 375000],
  [47, "症例検討会資料作成", 975000],
  [49, "安全性管理事務局業務", 113000],
  [50, "効果安全性評価委員会事務局業務", 113000],
  [52, "統計解析計画書作成", 600000],
  [52, "統計解析計画書・出力計画書作成", 1200000],
  [
    52,
    "統計解析計画書・出力計画書・解析データセット定義書・解析仕様書作成",
    2400000,
  ],
  [53, "中間解析プログラム作成、解析実施（シングル）", 48000],
  [53, "中間解析プログラム作成、解析実施（ダブル）", 84000],
  [54, "中間解析報告書作成（出力結果＋表紙）", 48000],
  [55, "最終解析プログラム作成、解析実施（シングル）", 48000],
  [55, "最終解析プログラム作成、解析実施（ダブル）", 84000],
  [56, "最終解析報告書作成（出力結果＋表紙）", 48000],
  [58, "研究結果報告書の作成", 2925000],
  [58, "CSRの作成支援", 5850000],
  [60, "監査計画書作成", 0],
  [61, "施設監査", 0],
  [62, "監査報告書作成", 0],
  [64, "試験開始準備費用", 0],
  [65, "症例登録", 0],
  [65, "症例報告", 0],
  [66, "症例登録", 0],
  [66, "症例報告", 0],
  [68, "国内学会発表", 0],
  [69, "国際学会発表", 0],
  [70, "論文作成", 300000],
  [72, "名古屋医療センターCRB申請費用(初年度)", 800000],
  [73, "名古屋医療センターCRB申請費用(2年目以降)", 200000],
  [75, "外部監査費用", 500000],
  [76, "施設監査費用", 300000],
  [78, "保険料", 0],
  [80, "QOL調査", 0],
  [81, "治験薬運搬", 150000],
  [82, "治験薬管理（中央）", 3000000],
  [83, "翻訳", 5000],
  [84, "CDISC対応費", 30000000],
  [85, "中央診断謝金", 0],
];
